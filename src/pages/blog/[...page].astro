---
// Component Imports
import SitePage from "../../components/SitePage.astro";
import Pagination from "../../components/Pagination.astro";
import sortPosts from "../../utils/sort-posts.mjs";
import {SITE_TITLE, SITE_KEYWORDS, SITE_DESCRIPTION, SITE_AUTHOR, SITE_CANONICAL_URL, SITE_BLOG_PAGE_SIZE} from "../../SETTINGS.mjs";
import JH from "../../components/jh/index.astro";
// const { sorted } = sortPosts(Astro
// .fetchContent('./posts/*.md'));
const pageLinks = [
  {url:'/blog', text:'Blog'},
  {url:'/#me', text:'Me'},
  {url:'/#projects', text:'Projects'}
];
const title = `${SITE_TITLE} -- Weblog`;

export async function getStaticPaths({ paginate }) {
  const { sorted } =
        sortPosts(
          Astro
          .fetchContent('./posts/*.md'));
  // Return a paginated collection of paths for all posts
  return paginate(sorted, { pageSize: SITE_BLOG_PAGE_SIZE });
}
// If set up correctly, The page prop now has everything that
// you need to render a single page (see next section).
const {page} = Astro.props;
const sorted = page.data;
---
<SitePage title={title} description={SITE_DESCRIPTION} keywords={SITE_KEYWORDS} author={SITE_AUTHOR} canonical={SITE_CANONICAL_URL} pageLinks ={pageLinks}>
          <section class="blog-top">
            <header>
              <JH class="logo"/>
              <p>John Henry's Blog</p>
            </header>
            <p>This is the place where I muse about technology.</p>
          </section>
          {sorted.map(({publishDate, url, title, description, heroImage}) =>
          <section class="blog-preview">
            <header>
              <a href={url}><p>{publishDate}</p>{title}</a>
            </header>
            <article>
              <img src={heroImage}>
              <p>{description}</p>
            </article>
            <footer>
              <a href={url}>Read more</a>
            </footer>
          </section>)}
          {page.lastPage > 1 ?
          <section class="blog-nav">
            <Pagination prefix="/blog/" page={page} />
          </section> : ''}
</SitePage>
